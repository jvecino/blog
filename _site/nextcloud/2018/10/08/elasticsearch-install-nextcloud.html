<!DOCTYPE html>
<html lang="en-US">
  <head>
    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>ElasticSearch install on Nextcloud | Joao Vecino tech blog</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="ElasticSearch install on Nextcloud" />
<meta name="author" content="Joao Carlos Correia Vecino Vieira" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ElasticSearch install on Nextcloud" />
<meta property="og:description" content="ElasticSearch install on Nextcloud" />
<link rel="canonical" href="http://localhost:4000/blog/nextcloud/2018/10/08/elasticsearch-install-nextcloud.html" />
<meta property="og:url" content="http://localhost:4000/blog/nextcloud/2018/10/08/elasticsearch-install-nextcloud.html" />
<meta property="og:site_name" content="Joao Vecino tech blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-08T00:00:00+02:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/blog/nextcloud/2018/10/08/elasticsearch-install-nextcloud.html","headline":"ElasticSearch install on Nextcloud","dateModified":"2018-10-08T00:00:00+02:00","datePublished":"2018-10-08T00:00:00+02:00","description":"ElasticSearch install on Nextcloud","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/nextcloud/2018/10/08/elasticsearch-install-nextcloud.html"},"author":{"@type":"Person","name":"Joao Carlos Correia Vecino Vieira"},"@type":"BlogPosting","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
      <link rel="stylesheet" href="/blog/assets/css/style.css?v=">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Joao Vecino tech blog</h1>
      <h2 class="project-tagline">This blog is born from a personal need to centralize acquired knowledge about homelab, self hosting and new technologies. It is especially dedicated to those people who are struggling to self-learning because they love it!</h2>
      
      
    
         <a href="/blog/" class="btn">Home</a>
      
	  
       <a href="/blog/nextcloud" class="btn">Nextcloud</a>
       <a href="/blog/unraid" class="btn">Unraid</a>
    
    </section>

    <section class="main-content">
      <h1>ElasticSearch install on Nextcloud</h1>
<hr />

<p><em>ElasticSearch is an open source, RESTful search engine built on top of Apache Lucene and released under an Apache license. It is Java-based and can search and index document files in diverse formats.</em></p>

<p><em>It allows fast searches inside Nextcloud from various sources like, local files, external storage, bookmarks etcâ€¦</em></p>

<p><em>Tested in <strong>ubuntu 16.04</strong></em></p>

<p>Here we go!</p>

<h2>Install from Nextcloud appstore</h2>

<p>Login to your Nextcloud server and go to Applications and install the plugin.</p>

<p><img src="/blog/assets/img/elasticsearchdownload.png" alt="nextclouddownload" /></p>

<h2>Install Java</h2>

<p><code>sudo add-apt-repository ppa:webupd8team/java<br />
sudo apt-get update<br />
sudo apt update &amp;&amp; sudo apt install oracle-java8-installer &amp;&amp; sudo apt install oracle-java8-set-default</code><br /></p>

<h2>Install and enable elasticsearch</h2>

<p><code>wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -<br /><br /> echo "deb https://artifacts.elastic.co/packages/6.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-6.x.list<br /><br />
sudo apt update &amp;&amp; sudo apt install elasticsearch<br />
sudo systemctl daemon-reload<br />
sudo systemctl enable elasticsearch<br />
sudo systemctl start elasticsearch</code><br /></p>

<h2>Install elasticsearch ingest-attachment plugin</h2>
<p><em>so Nextcloud can extract file attachments in common formats</em></p>

<p><code>sudo /usr/share/elasticsearch/bin/elasticsearch-plugin install ingest-attachment</code><br /></p>

<h2>Set elasticsearch to listen to localhost only</h2>
<p><code>sudo nano /etc/elasticsearch/elasticsearch.yml</code><br />
and add <code>network.host: 127.0.0.1</code><br /></p>

<h2>Restart elasticsearch</h2>
<p><code>sudo systemctl restart elasticsearch</code><br /></p>

<h2>Check if elasticsearch is running</h2>
<p><code>sudo curl 'localhost:9200/?pretty'<br /></code></p>

<h2>Configure Nextcloud</h2>
<p>Go to <strong>Applications</strong> &gt; <strong>fulltextsearch</strong> and change settings:</p>

<p><img src="/blog/assets/img/elasticsearchconfig.png" alt="nextcloudconfig" /></p>

<h2>Index Everything first</h2>
<p><code>sudo -u www-data php /var/www/html/nextcloud/occ fulltextsearch:index</code></p>

<h2>Enjoy!</h2>



      <footer class="site-footer">
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </section>

    
  </body>
</html>
